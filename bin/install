#!/bin/bash
#
# Install dotfiles - OS-aware wrapper
# Detects OS and runs the appropriate installer

set -e

# Colors
BLUE='\033[0;34m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
RED='\033[0;31m'
NC='\033[0m'

step() { echo ""; echo -e "${BLUE}-->$NC $1"; }
warn() { echo -e "${YELLOW}[!]${NC} $1"; }
error() { echo -e "${RED}[X]${NC} $1"; exit 1; }

# Detect OS
case "$(uname -s)" in
    Darwin*)
        step "Detected macOS"
        exec bash ~/.dotfiles/bin/install-macos
        ;;
    Linux*)
        if grep -qi microsoft /proc/version 2>/dev/null; then
            step "Detected WSL2"
        else
            step "Detected Linux"
        fi
        exec bash ~/.dotfiles/bin/install-linux
        ;;
    MINGW*|CYGWIN*|MSYS*)
        echo ""
        warn "Windows detected"
        echo "  Run the PowerShell installer instead:"
        echo "  powershell -ExecutionPolicy Bypass -File ~/.dotfiles/bin/install-windows.ps1"
        exit 1
        ;;
    *)
        error "Unknown operating system: $(uname -s)"
        ;;
esac
